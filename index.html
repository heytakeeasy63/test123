<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVA Flight Monitor Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #020617; color: #f8fafc; font-family: sans-serif; }
        .glass { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.1); }
        .card-go { border-top: 4px solid #10b981; } /* å‡ºå¢ƒç¶  */
        .card-back { border-top: 4px solid #3b82f6; } /* å…¥å¢ƒè— */
        select { background: #1e293b; color: white; border: 1px solid #334155; padding: 5px 10px; border-radius: 8px; }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-7xl mx-auto">
        <header class="glass sticky top-0 z-50 p-6 rounded-2xl mb-8 flex flex-wrap gap-4 items-center justify-between">
            <div>
                <h1 class="text-2xl font-black text-green-500">EVA MONITOR</h1>
                <p id="stats" class="text-xs text-gray-400">è¼‰å…¥ä¸­...</p>
            </div>

            <div class="flex flex-wrap gap-3">
                <select id="filter-airport" onchange="applyFilters()">
                    <option value="ALL">æ‰€æœ‰æ©Ÿå ´</option>
                </select>

                <select id="filter-date" onchange="applyFilters()">
                    <option value="ALL">æ‰€æœ‰æ—¥æœŸ</option>
                </select>

                <select id="filter-direction" onchange="applyFilters()">
                    <option value="ALL">å…¨éƒ¨èˆªå‘</option>
                    <option value="GO">ğŸ›« å‡ºå¢ƒ (TPE Depart)</option>
                    <option value="BACK">ğŸ›¬ å…¥å¢ƒ (TPE Arrive)</option>
                </select>
            </div>
        </header>

        <div id="flight-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
            </div>
    </div>

    <script>
        // é€™è£¡è«‹è²¼å…¥ä½ é‚£ä¸²é•·é•·çš„ JSON è³‡æ–™
        const rawData = [
            /* è«‹åœ¨æ­¤è™•è²¼å…¥ä½ å‰›æ‰ç”¢å‡ºçš„å®Œæ•´ JSON å…§å®¹ */
            // ç¯„ä¾‹ï¼š{"flight_no": "BR 184", "date": "2026-02-27", "route": "TPE NRT", ...},
        ];

        // åˆå§‹åŒ–ç¯©é¸ä¸‹æ‹‰é¸å–®
        function initFilters() {
            const airports = [...new Set(rawData.map(f => f.airport))].sort();
            const dates = [...new Set(rawData.map(f => f.date))].sort();

            const aptSelect = document.getElementById('filter-airport');
            airports.forEach(apt => {
                aptSelect.innerHTML += `<option value="${apt}">${apt}</option>`;
            });

            const dateSelect = document.getElementById('filter-date');
            dates.forEach(d => {
                dateSelect.innerHTML += `<option value="${d}">${d}</option>`;
            });
        }

        function renderFlights(data) {
            const container = document.getElementById('flight-container');
            const stats = document.getElementById('stats');
            container.innerHTML = '';
            stats.innerText = `é¡¯ç¤ºç­†æ•¸ï¼š${data.length} / ç¸½ç­†æ•¸ï¼š${rawData.length}`;

            data.forEach(f => {
                const isGo = f.direction === "GO";
                container.innerHTML += `
                    <div class="glass p-4 rounded-xl ${isGo ? 'card-go' : 'card-back'} hover:scale-105 transition-transform">
                        <div class="flex justify-between items-start mb-2">
                            <span class="text-lg font-bold">${f.flight_no}</span>
                            <span class="text-sm px-2 py-0.5 rounded ${isGo ? 'bg-green-900/50 text-green-400' : 'bg-blue-900/50 text-blue-400'}">
                                ${isGo ? 'ğŸ›« GO' : 'ğŸ›¬ BACK'}
                            </span>
                        </div>
                        <div class="flex justify-between text-xs text-gray-400 mb-3">
                            <span>${f.date}</span>
                            <span class="font-bold text-white">${f.airport} (${f.country})</span>
                        </div>
                        <div class="flex justify-between items-center bg-black/30 p-3 rounded-lg mb-3">
                            <div class="text-center"><p class="text-[10px] text-gray-500">DEP</p><p class="font-mono">${f.dep_time}</p></div>
                            <div class="text-gray-600">â†’</div>
                            <div class="text-center"><p class="text-[10px] text-gray-500">ARR</p><p class="font-mono">${f.arr_time}</p></div>
                        </div>
                        <div class="grid grid-cols-3 gap-2 text-center">
                            <div class="rounded p-1 bg-white/5">
                                <p class="text-[9px] text-gray-500">C</p>
                                <p class="font-bold ${parseInt(f.business) <= 0 ? 'text-red-500' : 'text-green-500'}">${f.business}</p>
                            </div>
                            <div class="rounded p-1 bg-white/5">
                                <p class="text-[9px] text-gray-500">Y</p>
                                <p class="font-bold ${parseInt(f.economy) <= 0 ? 'text-red-500' : 'text-green-500'}">${f.economy}</p>
                            </div>
                            <div class="rounded p-1 bg-white/5 border border-yellow-500/30">
                                <p class="text-[9px] text-gray-500">PAX</p>
                                <p class="font-bold text-yellow-500">${f.pax}</p>
                            </div>
                        </div>
                    </div>
                `;
            });
        }

        function applyFilters() {
            const apt = document.getElementById('filter-airport').value;
            const date = document.getElementById('filter-date').value;
            const dir = document.getElementById('filter-direction').value;

            let filtered = rawData.filter(f => {
                const matchApt = (apt === 'ALL' || f.airport === apt);
                const matchDate = (date === 'ALL' || f.date === date);
                const matchDir = (dir === 'ALL' || f.direction === dir);
                return matchApt && matchDate && matchDir;
            });

            // å…¨éƒ¨é¡¯ç¤ºæ™‚ï¼Œé è¨­æŒ‰æ—¥æœŸèˆ‡èˆªå‘æ’åº
            filtered.sort((a, b) => a.date.localeCompare(b.date) || a.direction.localeCompare(b.direction));
            renderFlights(filtered);
        }

        // å•Ÿå‹•
        initFilters();
        applyFilters();
    </script>
</body>
</html>
