<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é•·æ¦® 14 å¤©æ©Ÿä½ç›£æ§çœ‹æ¿</title>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js"></script>
    <style>
        body { font-family: 'PingFang TC', sans-serif; margin: 0; background-color: #f4f7f6; }
        .toolbar { padding: 15px; text-align: center; background: white; border-bottom: 1px solid #ddd; position: sticky; top: 0; z-index: 100; }
        .container { max-width: 1200px; margin: 20px auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h1 { color: #006241; font-size: 1.5rem; margin: 0 0 15px 0; }
        button { padding: 8px 16px; margin: 0 5px; cursor: pointer; border-radius: 4px; border: 1px solid #006241; background: white; color: #006241; }
        button.active { background: #006241; color: white; }
        #calendar { min-height: 700px; }
        /* è®“æœˆæª¢è¦–çš„å½ˆçª—å¥½çœ‹ä¸€é» */
        .fc-popover { border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); border: none; }
    </style>
</head>
<body>

<div class="toolbar">
    <h1>âœˆï¸ é•·æ¦®èˆªç­æ©Ÿä½ 14 å¤©å‹•æ…‹çœ‹æ¿</h1>
    <button id="btn-all" class="active">å…¨éƒ¨èˆªç­</button>
    <button id="btn-go">ğŸ›« åƒ…çœ‹å‡ºå¢ƒ</button>
    <button id="btn-back">ğŸ›¬ åƒ…çœ‹å…¥å¢ƒ</button>
</div>

<div class="container">
    <div id="calendar"></div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        var calendarEl = document.getElementById('calendar');
        var calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'dayGridMonth', // 1. é è¨­ä½¿ç”¨æœˆæª¢è¦–
            locale: 'zh-tw',
            headerToolbar: {
                left: 'prev,next today',
                center: 'title',
                right: 'dayGridMonth,listWeek' // æä¾›æœˆæª¢è¦–èˆ‡æ¸…å–®æ¨¡å¼åˆ‡æ›
            },
            dayMaxEvents: 3, // 2. æ¯æ ¼åªé¡¯ç¤º 3 å€‹ï¼Œå¤šå‡ºçš„æœƒè®Šæˆ "+more" é»é–‹å½ˆçª—
            events: './weekly_flights.json', // è®€å– JSON
            
            eventDidMount: function(info) {
                // æ»‘é¼ ç§»ä¸Šå»é¡¯ç¤ºè©³ç´° Pax
                info.el.title = `Pax: ${info.event.extendedProps.pax}\n${info.event.extendedProps.route}`;
            }
        });

        calendar.render();

        // 3. éæ¿¾åŠŸèƒ½å¯¦ä½œ
        document.getElementById('btn-all').onclick = function() {
            filterEvents('all'); toggleActive(this);
        };
        document.getElementById('btn-go').onclick = function() {
            filterEvents('GO'); toggleActive(this);
        };
        document.getElementById('btn-back').onclick = function() {
            filterEvents('BACK'); toggleActive(this);
        };

        function filterEvents(type) {
            calendar.getEvents().forEach(event => {
                if (type === 'all') {
                    event.setProp('display', 'auto');
                } else if (event.extendedProps.direction === type) {
                    event.setProp('display', 'auto');
                } else {
                    event.setProp('display', 'none');
                }
            });
        }

        function toggleActive(btn) {
            document.querySelectorAll('button').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }
    });
</script>

</body>
</html>
